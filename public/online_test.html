<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChemGuide | Online Test</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="icon" href="assets/images/logo.png" type="image/x-icon">
</head>
<body>
  <!-- 🔹 Header -->
  <header>
    <nav class="navbar">
      <div class="logo">
        <img src="assets/images/logo.png" alt="ChemGuide Logo">
        <span>ChemGuide</span>
      </div>
      <!-- Hamburger menu -->
      <span class="menu-toggle" id="menu-toggle">&#9776;</span>
      <ul class="nav-links" id="nav-links">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="study_materials.html">Study Materials</a></li>
        <li><a href="online_test.html">Online Test</a></li>
        <li><a href="login.html">Account</a></li>
      </ul>
    </nav>
  </header>

  <!-- 🔹 Online Tests Section -->
  <section class="tests-container">
    <h2>📝 Available Online Tests</h2>
    <p>Select a test to start. You can also filter by tag.</p>

    <!-- Sorting -->
    <div class="filter-bar">
      <label for="tagFilter">Filter by Tag:</label>
      <select id="tagFilter">
        <option value="all">All</option>
        <option value="Organic">Organic</option>
        <option value="Inorganic">Inorganic</option>
        <option value="Physical">Physical</option>
        <option value="General">General</option>
      </select>
    </div>

    <!-- Test List -->
    <div id="testsGrid" class="tests-grid">
      <!-- Tests will be loaded dynamically -->
    </div>
  </section>

  <!-- 🔹 Footer -->
  <footer>
    <p>© 2025 ChemGuide | Online Test Portal</p>
  </footer>

  <script>
    async function fetchTests() {
      try {
        const res = await fetch('/api/tests'); // Backend API
        const tests = await res.json();
        renderTests(tests);

        // Handle filtering
        document.getElementById("tagFilter").addEventListener("change", function() {
          const selectedTag = this.value;
          const filtered = selectedTag === "all" ? tests : tests.filter(t => t.tag === selectedTag);
          renderTests(filtered);
        });

      } catch (err) {
        console.error("❌ Error fetching tests:", err);
      }
    }

    function renderTests(tests) {
      const container = document.getElementById("testsGrid");
      container.innerHTML = "";

      if (tests.length === 0) {
        container.innerHTML = "<p>No tests available.</p>";
        return;
      }

      tests.forEach(test => {
        const card = document.createElement("div");
        card.classList.add("test-card");

        card.innerHTML = `
          <h3>${test.title}</h3>
          <p><strong>Category:</strong> ${test.category}</p>
          <p><strong>Tag:</strong> ${test.tag}</p>
          <button onclick="startTest('${test.id}')">Start Test</button>
        `;

        container.appendChild(card);
      });
    }

    function startTest(testId) {
      // Redirect to test-taking page
      window.location.href = `take_test.html?id=${testId}`;
    }

    // Load tests on page load
    fetchTests();

     // ✅ Mobile menu toggle
    const menuToggle = document.getElementById("menu-toggle");
    const navLinks = document.getElementById("nav-links");

    menuToggle.addEventListener("click", () => {
      navLinks.classList.toggle("show");
    });

  </script>
</body>
</html>
